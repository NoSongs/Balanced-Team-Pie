<!DOCTYPE html>
<head>
	<meta charset="utf-8" />
	<!-- Set the viewport width to device width for mobile -->
	<meta name="viewport" content="width=device-width" />
	
	<title>Balanced Team Pie - LUXr</title>
  
	<!-- Included CSS Files -->
	<link rel="stylesheet" href="css/jockstrap.css">

	<!--[if lt IE 9]>
		<link rel="stylesheet" href="css/ie.css">
	<![endif]-->

	
	<!-- IE Fix for HTML5 Tags -->
	<!--[if lt IE 9]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js">
        </script>
    <script type="text/javascript" src="js/d3.js"></script>
    <script type="text/javascript" src="js/d3.layout.js"></script>

    <style type="text/css">
    .team-select {
        cursor: pointer;
    }
    </style>
</head>
<body>
<div class="container">

    <div class="page" id="start-page">
        Company Name
        <br/>
        <input id="company-name" type="text"></input>

        <br/>
        <br/>

        Choose Team Type
        <br/>
        <div class="team-select">
            Tech Startup
        </div>
        <div class="team-select">
            Circus Performers
        </div>
        <div class="team-select">
            Santas Toy Workshop
        </div>

        <br/>

        <div class="next" style="display:none;">
        <a href="javascript: void(0);">Next</a>
        </div>
        <script>
        $(document).ready(function(){
            var team_select_background = $('.team-select').css('background-color');
            var company_name, team_type;
            function show_next() {
                $('.next').show();
            }
            $('.team-select').click(function(){
                $('.team-select').css('background-color', team_select_background);
                $(this).css('background-color', 'yellow');
                show_next();
            });
            $('.next a').click(function(){
                $('.page').hide();
                $('#code-page').show();
                $('.company-name').html($('#company-name').val());
            });
        });
        </script>
    </div><!-- start-page -->

    <div class="page" id="code-page" style="display:none;">
        Congratulations!  You've created a new Balanced Team Pie for <span
        class="company-name">Foo</span>

        <br/>
        <br/>

        Give you team members this access code so they can connection:
        
        <br/>
        <br/>

        X 9 L o

        <br/>
        <br/>

        <div class="begin">
        <a href="javascript: void(0);">Begin</a>
        </div>
    </div><!-- code page-->


    <!-- vote page-->
    <script id="tpl-vote-page-option" type="text/x-jquery-tmpl">
        {{each options}}
        <div>
            ${$value}
            <input type="radio" name="category-${$index}" value="0" />0
            <input type="radio" name="category-${$index}" value="1" />1
            <input type="radio" name="category-${$index}" value="2" />2
            <input type="radio" name="category-${$index}" value="3" />3
            <input type="radio" name="category-${$index}" value="4" />4
        </div>
        {{/each}}
    </script>
    <div class="page" id="vote-page" style="display:none">
        How are you called?
        <br/>
        <input id="member-name" type="text"></input>
        <br/>
        <br/>
        How would you rate you ability in these areas?
        <br/>
        <br/>
        <div class="options">
        </div>
        <br/>
        <br/>
        <div class="results">
        <a href="javascript: void(0);">See Results</a>
        </div>
    </div><!-- vote page-->


    <div class="page" id="pie-page">
        <div id="the-pie">
        </div>
    </div><!-- pie page-->

</div>

<script>
$(document).ready(function(){
    var options = [
        "Juggling",
        "Mini car driving",
        "Tightrope walking",
        "Lion taming",
        "Fire breathing",
        "Curiously deformed",
        "Knife throwing",
        "Knife target",
        ];

    $('.begin a').click(function(){
        $('.page').hide();
        $('#vote-page').show();
        $('#vote-page').show();
        $( "#tpl-vote-page-option" ).tmpl({options:options}).appendTo(".options");
        draw_pie(options);
    });

    $('.results a').click(function(){
        console.log('foo');
        $('.page').hide();
        $('#pie-page').show();
    });

    function draw_pie(options) {
        var slice_spacing = .00;
        var w = 450,
            h = 450,
            r = Math.min(w, h) / 2,
            color = d3.scale.category20(),
            donut = d3.layout.pie(),
            arc = d3.svg.arc().innerRadius(r * .90).outerRadius(r);

        var vis = d3.select($("#pie-page").get(0))
          .append("svg:svg")
            .data([options])
            .attr("width", 600)
            .attr("height", 600);

        var arcs = vis.selectAll("g.arc")
            .data(donut)
          .enter().append("svg:g")
            .attr("class", "arc")
            .attr("transform", function(d,i) {
                var xoffset = r+100;
                var yoffset = r+20;
                xoffset += 5 * Math.sin((i+.5)*((Math.PI*2)/8));
                yoffset += -5 * Math.cos((i+.5)*((Math.PI*2)/8));
                return "translate(" + xoffset + "," + yoffset + ")";
            });

        arcs.append("svg:path")
            .attr("fill", function(d, i) { return '#000'; })
            .attr("id", function(d, i) { return "slice-" + i })
            .attr("d", function(d, i) {
                var a = ((Math.PI*2)/8);
                return arc
                    .startAngle((i*a)+slice_spacing)
                    .endAngle(((i+1)*a) -slice_spacing)
                    ();
                });
        arcs.append("svg:text")
            .attr("fill", "#FFF")
            .attr("dy", "1.0em")
            .attr("text-anchor", "middle")
                .append("svg:textPath")
                    .attr("xlink:href", function(d,i) { return "#slice-" + i; })
                    .attr("startOffset", "22%")
                    .text(function(d, i) { return options[i]; });
    } // end draw pie
    // draw_pie(options);
});
</script>

</body>
</html>
